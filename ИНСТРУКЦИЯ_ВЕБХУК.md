# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –≤–µ–±—Ö—É–∫–∞ –ë–∏—Ç—Ä–∏–∫—Å24

## üîÑ –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –≤—Ö–æ–¥—è—â–∏–º –∏ –∏—Å—Ö–æ–¥—è—â–∏–º –≤–µ–±—Ö—É–∫–æ–º

**–í—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫ (Incoming Webhook)** - —ç—Ç–æ —Ç–æ, —á—Ç–æ —É –≤–∞—Å –£–ñ–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
- Bitrix24 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç URL (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://your-domain.bitrix24.ru/rest/xxx/`)
- **–ú–´** –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —ç—Ç–æ—Ç URL, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Bitrix24
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `bitrix24_client.py` –¥–ª—è –≤—ã–∑–æ–≤–∞ API –º–µ—Ç–æ–¥–æ–≤ (`user.get`, `tasks.task.add` –∏ —Ç.–¥.)
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `BITRIX24_DOMAIN`, `BITRIX24_WEBHOOK_TOKEN`

**–ò—Å—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫ (Outgoing Webhook)** - —ç—Ç–æ —Ç–æ, —á—Ç–æ –º—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –°–ï–ô–ß–ê–°:
- **Bitrix24** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ **–ù–ê–®** —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ —Å–æ–±—ã—Ç–∏—è—Ö (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç.–¥.)
- –ú—ã —É–∫–∞–∑—ã–≤–∞–µ–º URL –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –≤ Bitrix24
- Bitrix24 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –Ω–∞—Å –æ —Å–æ–±—ã—Ç–∏—è—Ö
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è: `WEBHOOK_URL` (URL –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:**
- **–í—Ö–æ–¥—è—â–∏–π** = –º—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É Bitrix24
- **–ò—Å—Ö–æ–¥—è—â–∏–π** = Bitrix24 –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö

## üìã –ö–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

1. **`WEBHOOK_URL`** - –ø–æ–ª–Ω—ã–π URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ü—Ä–∏–º–µ—Ä: `https://your-app-name.railway.app`
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é Railway: `https://${{RAILWAY_PUBLIC_DOMAIN}}`

2. **`BITRIX24_OUTGOING_WEBHOOK_TOKEN`** - —Ç–æ–∫–µ–Ω –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –≤–µ–±—Ö—É–∫–∞
   - –ü–æ–ª—É—á–∏—Ç–µ —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –≤–µ–±—Ö—É–∫–∞ –≤ Bitrix24
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç Bitrix24 (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
   - –ü—Ä–∏–º–µ—Ä: `ssmtodolnza09g2rnm1ucbyzumejtr39`

### –ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

- **Railway:** Variables ‚Üí –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
  - `WEBHOOK_URL=https://your-app-name.railway.app`
  - `BITRIX24_OUTGOING_WEBHOOK_TOKEN=ssmtodolnza09g2rnm1ucbyzumejtr39`
  
- **–õ–æ–∫–∞–ª—å–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å –≤ —Ñ–∞–π–ª `.env`:
  ```
  WEBHOOK_URL=https://your-domain.com
  BITRIX24_OUTGOING_WEBHOOK_TOKEN=ssmtodolnza09g2rnm1ucbyzumejtr39
  ```

## üîó URL –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Bitrix24

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `WEBHOOK_URL`, URL –¥–ª—è –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –≤–µ–±—Ö—É–∫–∞ –±—É–¥–µ—Ç:

```
https://your-domain.com/api/bitrix/webhook
```

## ‚úÖ –ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –≤—ã–±—Ä–∞—Ç—å?

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

1. **`ONUSERUPDATE`** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Telegram ID –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è

2. **`ONUSERADD`** - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
   - ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** - –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ß—Ç–æ –∏–∑ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ù–ï –Ω—É–∂–Ω–æ (–¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞):

‚ùå –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ –≤–∞—à–µ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–¥–µ.

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:
- –°–æ–±—ã—Ç–∏—è –∑–∞–¥–∞—á (`ONTASKADD`, `ONTASKUPDATE`) - –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–¥–∞—á–∞—Ö
- –°–æ–±—ã—Ç–∏—è CRM (`ONCRMLEADADD`, `ONCRMDEALADD`) - –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å CRM
- –°–æ–±—ã—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (`ONIMBOTMESSAGEADD`) - –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —á–∞—Ç–æ–º

–ò—Ö –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ, —Ä–∞—Å—à–∏—Ä–∏–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –∫–æ–¥–µ.

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–î–ª—è Railway:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Railway
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Variables**
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   - **Name:** `WEBHOOK_URL`
     **Value:** `https://your-app-name.railway.app` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω)
   - **Name:** `BITRIX24_OUTGOING_WEBHOOK_TOKEN`
     **Value:** `ssmtodolnza09g2rnm1ucbyzumejtr39` (–≤–∞—à —Ç–æ–∫–µ–Ω –∏–∑ Bitrix24)

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
1. –î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `.env`:
   ```
   WEBHOOK_URL=https://your-domain.com
   BITRIX24_OUTGOING_WEBHOOK_TOKEN=ssmtodolnza09g2rnm1ucbyzumejtr39
   ```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏—Å—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫ –≤ Bitrix24

1. –í–æ–π–¥–∏—Ç–µ –≤ –≤–∞—à –ø–æ—Ä—Ç–∞–ª Bitrix24
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è** ‚Üí **–ò—Å—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫**
3. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫"**

4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Telegram ID
   - **–°–æ–±—ã—Ç–∏–µ:** `ONUSERUPDATE`
   - **URL –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞:** `https://your-domain.com/api/bitrix/webhook`
     (–∑–∞–º–µ–Ω–∏—Ç–µ `your-domain.com` –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω –∏–∑ `WEBHOOK_URL`)
   - **–ú–µ—Ç–æ–¥:** POST
   - **–ü—Ä–∞–≤–∞:** –í—ã–±–µ—Ä–∏—Ç–µ `user` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
   - **–ê–∫—Ç–∏–≤–µ–Ω:** –î–∞

5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**

6. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ–∑–¥–∞–π—Ç–µ –≤—Ç–æ—Ä–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è `ONUSERADD` —Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

1. –û–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Bitrix24 (–∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ–ª–µ —Å Telegram ID)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
   ```
   ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ Bitrix24 (–∏—Å—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫): Telegram ID X ‚Üí Bitrix24 User ID Y
   ```

## üìù –ò—Ç–æ–≥–æ: —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   - `WEBHOOK_URL` - URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - `BITRIX24_OUTGOING_WEBHOOK_TOKEN` - —Ç–æ–∫–µ–Ω –∏–∑ Bitrix24
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫ –≤ Bitrix24 —Å —Å–æ–±—ã—Ç–∏–µ–º `ONUSERUPDATE`
3. ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –≤–µ–±—Ö—É–∫–∞ –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. ‚úÖ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ `ONUSERADD`
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ –ª–æ–≥–∏

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ù—É–∂–Ω—ã –ª–∏ –¥—Ä—É–≥–∏–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞?**  
A: –ù–µ—Ç, –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ `ONUSERUPDATE` –∏ `ONUSERADD`.

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤–µ–±—Ö—É–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?**  
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å URL (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å HTTPS)
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
- –ü—Ä–∞–≤–∞ –≤–µ–±—Ö—É–∫–∞ –≤ Bitrix24 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `user`)

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –≤–µ–±—Ö—É–∫ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π?**  
A: –î–∞, –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –æ–¥–∏–Ω URL –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è.

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. —Ñ–∞–π–ª `BITRIX_OUTGOING_WEBHOOK.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
